<!DOCTYPE html>
<html lang="en" ng-app="SharpScratch">
<head>
  <meta charset="utf-8">
  <title>Sharp Scratch</title>

  <!-- bootstrap -->
  <link href="/deps/bootstrap/css/bootstrap.css" rel="stylesheet">
  <script src="/deps/bootstrap/js/bootstrap.js"></script>

  <!-- underscore and angular -->
  <script src="/deps/underscore.js"></script>
  <script src="/deps/angular.js"></script>
  <script src="/deps/angular-resource.js"></script>

  <!-- shared css/less -->
  <link href="body.less" rel="stylesheet/less" type="text/css">

  <!-- controllers -->
  <script src="procedure.js"></script>
  <link href="procedure.less" rel="stylesheet/less" type="text/css">

  <script src="new_procedure.js"></script>
  <link href="new_procedure.less" rel="stylesheet/less" type="text/css">

  <script src="search.js"></script>
  <link href="search.less" rel="stylesheet/less" type="text/css">


  <!-- less, needs to be before all less stylesheets -->
  <script src="/deps/less-1.3.3.min.js"></script>
</head>
<body>

  <div class="new_procedure" ng-controller="NewProcedure" ng-show="show">
    <form class="form-horizontal" ng-submit="save()">
      <legend>New Procedure</legend>

      <div class="control-group">
        <label class="control-label">Title</label>
        <div class="controls">
          <input name="title" ng-model="title" type="text" required>
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Consent</label>
        <div class="controls">
          <textarea name="consent" ng-model="consent"></textarea>
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Materials</label>
        <div class="controls">
          <textarea name="materials" ng-model="materials"></textarea>
        </div>
      </div>

      <legend>Steps</legend>

      <div ng-repeat="step in steps">
        <div class="control-group">
          <label class="control-label">Title of {{ $index + 1 }}</label>
          <div class="controls">
            <input name="step_title" class="step_title" type="text">
          </div>
        </div>
        <div class="control-group">
          <label class="control-label">Description</label>
          <div class="controls">
            <textarea name="step_text" class="step_text"></textarea>
          </div>
        </div>
      </div>

      <div class="control-group">
        <div class="controls">
          <button class="btn" ng-click="inc(steps)">Add a Step</button>
        </div>
      </div>

      <legend>Complications</legend>

      <div ng-repeat="complication in complications">
        <div class="control-group">
          <label class="control-label">Title of {{ $index + 1 }}</label>
          <div class="controls">
            <input name="complication_title" class="complication_title" type="text">
          </div>
        </div>
        <div class="control-group">
          <label class="control-label">Description</label>
          <div class="controls">
            <textarea name="complication_text" class="complication_text"></textarea>
          </div>
        </div>
      </div>

      <div class="control-group">
        <div class="controls">
          <button class="btn" ng-click="inc(complications)">Add a Complication</button>
        </div>
      </div>

      <div class="form-actions">
        <button class="btn-primary btn" ng-click="save()">Save</button>
      </div>
    </form>
  </div>

  <div class="procedure" ng-controller="Procedure" ng-show="show">
    <h1>{{ title }}</h1>

    <ul class="toc">
      <li>Consent</li>

      <li class="label">Steps:</li>
      <li ng-repeat="step in steps"
          ng-init="active = step.variants[0]">
        <a href="#step-{{ step.id }}">{{ active.title }}</a>
      </li>
    </ul>

    <div class="step" ng-repeat="step in steps" id="step-{{ step.id }}">

      <article class="active">
        <h2>{{ step.active.title }}</h2>
        {{ step.active.text }}
        <h3>What to say?</h3>
        {{ step.active.say }}
      </article>

      <div class="rest">
        <div class="alternatives">
          <div ng-repeat="variant in step.variants"
              class="alternative">
            <div class="points">{{ variant.points }}</div>
            {{ variant.text }}
          </div>
        </div>
        <div class="comments">
        </div>
      </div>

    </div>
  </div>

  <div class="search" ng-controller="Search">
    <h1>Search for a procedure</h1>
    <form class="form-search" ng-submit="search()">
      <input type="text" ng-model="term" class="input-medium search-query" required>
      <input  ng-disabled="!term" type="submit" class="btn-primary btn" value="Search">
    </form>

    <div class="querying" ng-show="status == 'querying'">Query on it's way...</div>

    <p class="create_text" ng-show="status == 'got_reply'">
      <button class="btn" ng-click="" ng-disabled="!term">Create</button> a new procedure based on your search.
    </p>

    <div class="results" ng-show="status == 'got_reply'">
      <a class="result" ng-repeat="result in results"
        ng-bind="result.title" href="#{{result.id}}"></a>
    </div>
  </div>

</body>
</html>
